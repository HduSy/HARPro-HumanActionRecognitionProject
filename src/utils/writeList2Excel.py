import xlwt

save = {
    'val_loss': [0.37244848733317254, 0.1918569163407448, 0.13297886933390704, 0.10906616285311954, 0.09287435833609185,
                 0.0883216555216637, 0.09706906429934338, 0.08047411159542002, 0.07807719429460491, 0.07874355198820938,
                 0.07621783280086564, 0.06571445224421732, 0.07871131727382555, 0.09091244490559958,
                 0.08343057875885436, 0.09984931651864065, 0.10741755615894288, 0.10554912476184669,
                 0.09090133762237024, 0.09706890622443948, 0.1043981253721338, 0.10205549571250842, 0.08291026799557374,
                 0.10356877122099906, 0.09499799930121126, 0.09573271934464793, 0.09617754173019023],
    'val_accuracy': [0.8716944456100464, 0.9314397573471069, 0.9490695595741272, 0.9578844308853149, 0.9578844308853149,
                     0.9647404551506042, 0.9588638544082642, 0.9676787257194519, 0.9706170558929443, 0.9676787257194519,
                     0.9696376323699951, 0.9774730801582336, 0.9696376323699951, 0.9666993021965027, 0.9725759029388428,
                     0.9696376323699951, 0.9666993021965027, 0.9715964794158936, 0.9706170558929443, 0.9706170558929443,
                     0.9686581492424011, 0.9706170558929443, 0.9686581492424011, 0.9666993021965027, 0.9696376323699951,
                     0.9706170558929443, 0.9725759029388428],
    'loss': [1.0588056978071159, 0.3661842677580768, 0.2300876928223579, 0.16526776882940533, 0.12938372189216796,
             0.10106191851979272, 0.08631793018637388, 0.07122141330220345, 0.05793247663541132, 0.04396708324580794,
             0.03724034425123562, 0.02710548719499553, 0.02113161714793394, 0.017920239549901063, 0.01676249119267111,
             0.012750336053217062, 0.013015233318619, 0.023829412334595557, 0.015767747098533347, 0.023427084027873718,
             0.016360815557661567, 0.015014780027740331, 0.010585977679450796, 0.009685612422807872,
             0.006355769074787906, 0.004569264334908266, 0.003940110285937838],
    'accuracy': [0.63373995, 0.87072533, 0.9234372, 0.94500107, 0.9551296, 0.9643868, 0.9721194, 0.97821826, 0.98279244,
                 0.9890002, 0.99041605, 0.9937922, 0.9961882, 0.99597037, 0.9956437, 0.997604, 0.9967327, 0.99401003,
                 0.996406, 0.9934655, 0.99607927, 0.99607927, 0.99684167, 0.9974951, 0.9986931, 0.99934655, 0.99945545]}


def write2Excel(v_loss, v_acc, loss, acc):
    f = xlwt.Workbook()  # 创建工作薄
    sheet1 = f.add_sheet(u'sheet1', cell_overwrite_ok=True)  # 创建sheet
    sheet1.write(0, 0, '迭代次数/轮')
    sheet1.write(0, 1, 'val_loss')
    sheet1.write(0, 2, 'val_acc')
    sheet1.write(0, 3, 'loss')
    sheet1.write(0, 4, 'acc')

    j = 1
    for i in range(1, 28):
        sheet1.write(j, 0, i)
        j += 1
    j = 1
    for i in v_loss:
        sheet1.write(j, 1, i)  # 循环写入
        j = j + 1
    j = 1
    for i in v_acc:
        sheet1.write(j, 2, i)  # 循环写入
        j = j + 1
    j = 1
    for i in loss:
        sheet1.write(j, 3, i)  # 循环写入
        j = j + 1
    j = 1
    for i in acc:
        sheet1.write(j, 4, i)  # 循环写入
        j = j + 1
    f.save('text.xls')  # 保存文件


if __name__ == '__main__':
    val_loss, val_acc, loss, acc = save['val_loss'], save['val_accuracy'], save['loss'], save['accuracy']
    write2Excel(val_loss, val_acc, loss, acc)
