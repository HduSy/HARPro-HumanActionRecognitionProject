import xlwt

save = {
    'val_loss': [0.784504395227645, 0.40700363230270015, 0.28927978836982293, 0.2168375272417165, 0.18946201996556644,
                 0.15055739810089552, 0.1471310704946518, 0.11536627134372449, 0.10044612743066242, 0.09219997525819658,
                 0.08536279917851423, 0.08279856490859154, 0.07272135582705298, 0.0877626858364496, 0.08228056517412648,
                 0.07435861982510975, 0.0675134652466126, 0.06668254133109873, 0.07233137534610157, 0.07618912983436371,
                 0.0886063732463738, 0.06902254826217345, 0.06756081317247291, 0.08001656496319277, 0.07138156142788533,
                 0.08889858302250353, 0.0761872258860973],
    'val_accuracy': [0.7981744408607483, 0.8640973567962646, 0.8924949169158936, 0.9259634613990784, 0.9320486783981323,
                     0.9503042697906494, 0.9442190527915955, 0.9553752541542053, 0.9634888172149658, 0.9604462385177612,
                     0.9645030498504639, 0.9634888172149658, 0.9655172228813171, 0.9624746441841125, 0.9685598611831665,
                     0.9675456285476685, 0.9746450185775757, 0.9726166129112244, 0.9756592512130737, 0.9665314555168152,
                     0.9655172228813171, 0.9736308455467224, 0.9726166129112244, 0.9655172228813171, 0.9736308455467224,
                     0.9665314555168152, 0.9726166129112244],
    'loss': [1.355701211864485, 0.7402173044232775, 0.4686322053757372, 0.3709065175522166, 0.27438969760452775,
             0.2314994091282394, 0.19126791071159957, 0.15475254540271652, 0.12749311514293282, 0.12201134152880543,
             0.1098957783653614, 0.09342504217880501, 0.07881304214012495, 0.075350854929512, 0.062480275999737656,
             0.0559447087699057, 0.0558920404209908, 0.04419481082389888, 0.03986073789606839, 0.038108010677585805,
             0.042632758401935325, 0.03269335569153275, 0.028436692028043234, 0.03320027218270671, 0.029472369434173067,
             0.02721868702345152, 0.019301986212183955],
    'accuracy': [0.51243025, 0.74454594, 0.83688486, 0.8779807, 0.90892947, 0.92770165, 0.94089293, 0.9518011, 0.963724,
                 0.96347034, 0.9670218, 0.9738711, 0.97843736, 0.9794521, 0.98173517, 0.985033, 0.9870624, 0.98883814,
                 0.9903602, 0.98959917, 0.9901065, 0.9923897, 0.99264336, 0.99213594, 0.99289703, 0.99289703,
                 0.9956875]}


def write2Excel(v_loss, v_acc, loss, acc):
    f = xlwt.Workbook()  # 创建工作薄
    sheet1 = f.add_sheet(u'sheet1', cell_overwrite_ok=True)  # 创建sheet
    sheet1.write(0, 0, '迭代次数/轮')
    sheet1.write(0, 1, 'val_loss')
    sheet1.write(0, 2, 'val_acc')
    sheet1.write(0, 3, 'loss')
    sheet1.write(0, 4, 'acc')

    j = 1
    for i in range(1, 28):
        sheet1.write(j, 0, i)
        j += 1
    j = 1
    for i in v_loss:
        sheet1.write(j, 1, i)  # 循环写入
        j = j + 1
    j = 1
    for i in v_acc:
        sheet1.write(j, 2, i)  # 循环写入
        j = j + 1
    j = 1
    for i in loss:
        sheet1.write(j, 3, i)  # 循环写入
        j = j + 1
    j = 1
    for i in acc:
        sheet1.write(j, 4, i)  # 循环写入
        j = j + 1
    f.save('text.xls')  # 保存文件


if __name__ == '__main__':
    val_loss, val_acc, loss, acc = save['val_loss'], save['val_accuracy'], save['loss'], save['accuracy']
    write2Excel(val_loss, val_acc, loss, acc)
